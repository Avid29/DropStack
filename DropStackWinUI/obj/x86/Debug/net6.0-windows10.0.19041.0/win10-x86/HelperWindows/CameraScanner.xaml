<?xml version="1.0" encoding="utf-8"?>
<Window x:ConnectionId='1'
    x:Class="DropStackWinUI.HelperWindows.CameraScanner"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DropStackWinUI.HelperWindows"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Window.SystemBackdrop>
        <MicaBackdrop Kind="Base"/>
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="200"/>
        </Grid.RowDefinitions>
        
        <!-- This handles the animations -->

        <Grid.Resources>
            <Storyboard x:ConnectionId='2' x:Name="CameraFeedToGalleryAnimation">
                <DoubleAnimation x:ConnectionId='3'
                    Storyboard.TargetName="animationPreview"
                    Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                    From="0"
                                                                                              
                    Duration="0:0:1"/>
                <DoubleAnimation x:ConnectionId='4'
                    Storyboard.TargetName="animationPreview"
                    Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                    From="0"
                                                                                              
                    Duration="0:0:1"/>
            </Storyboard>
        </Grid.Resources>
        
        <!-- End of animation handling -->
        
        <Rectangle x:ConnectionId='5' x:Name="TitleBarRectangle" Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Opacity="0"/>
        
        <StackPanel Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">

            <Grid Background = "Black">
                <!-- Image Previewing Feed /-->
                <Image x:ConnectionId='13' x:Name="imagePreview" Stretch="Uniform" RenderTransformOrigin="0.5, 0.5" VerticalAlignment="Stretch" />
                
                <!-- Image used to animate -->
                <Image x:ConnectionId='14' x:Name="animationPreview" Opacity="0" Stretch="Uniform" RenderTransformOrigin="0.5, 0.5" VerticalAlignment="Stretch" >
                    <Image.RenderTransform>
                        <TranslateTransform/>
                    </Image.RenderTransform>
                </Image>
            </Grid>

            <StackPanel Orientation="Vertical" Spacing="10" Margin="50">
                <Button x:ConnectionId='9' x:Name="BtnInitCamera"                          Content="Initialize Camera" />
                <Button x:ConnectionId='10' x:Name="BtnStartPreview"                                   Content="Start Preview" />
                <Button x:ConnectionId='11' x:Name="BtnCapturePhoto"                            Content="Capture Photo"/>
                <Button x:ConnectionId='12' x:Name="BtnStopPreview"                                  Content="Stop Preview" />
            </StackPanel>
        </StackPanel>

        <ScrollViewer HorizontalScrollMode="Enabled" Grid.Row="2" VerticalScrollMode="Disabled" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
            <GridView x:ConnectionId='6'   
                    x:Name="GalleryGridView"
                    Height="160">
                <GridView.ItemContainerTransitions>
                    <TransitionCollection>
                        <EntranceThemeTransition  FromVerticalOffset="0" />
                    </TransitionCollection>
                </GridView.ItemContainerTransitions>
                <GridView.ItemTemplate>
                    <DataTemplate>
                        <Grid HorizontalAlignment="Center">
                            <Image x:Name="TargetImageDisplay" Source="{Binding DisplayedImage}" Opacity="{Binding GridOpacity}" RenderTransformOrigin="0.5, 0.5" Stretch="Uniform" MaxHeight="150" VerticalAlignment="Stretch"/>
                        </Grid>
                    </DataTemplate>
                </GridView.ItemTemplate>
            </GridView>
        </ScrollViewer>
    </Grid>
</Window>

